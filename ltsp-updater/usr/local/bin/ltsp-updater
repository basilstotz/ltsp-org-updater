#!/bin/sh

test $(id --user) = 0 || exec sudo $0

update(){
    if test -z "$(which ltsp)";then
        if cat /etc/issue|grep -q DEBIAN;then
            wget https://ltsp.org/misc/ltsp-ubuntu-ppa-focal.list \
		-O /etc/apt/sources.list.d/ltsp-ubuntu-ppa-focal.list
            wget https://ltsp.org/misc/ltsp_ubuntu_ppa.gpg \
		-O /etc/apt/trusted.gpg.d/ltsp_ubuntu_ppa.gpg
	else
  	   add-apt-repository ppa:ltsp
	fi    
        apt update
        apt-get install cowsay lolcat
        apt-get install --install-recommends \
            ltsp ltsp-binaries dnsmasq nfs-kernel-server \
            openssh-server squashfs-tools ethtool net-tools epoptes
    fi
    ltsp dnmasq
    ltsp image /
    ltsp nfs
    ltsp ipxe
    ltsp initrd
    for I in $(seq 20);do echo;done    
    /usr/games/cowsay "LTSP is ready!" | /usr/games/lolcat
}

update
sleep 5
exit
